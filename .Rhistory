df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, max(c.JAHR) FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
ORDER BY a.RAUMEINHEIT_ID) c
GROUP BY c.RAUMEINHEIT_ID,c.JAHR
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, max(c.JAHR) FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
ORDER BY a.RAUMEINHEIT_ID) c
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID,c.JAHR
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, max(c.JAHR) FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID,c.JAHR
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, max(c.JAHR) FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
names(df)
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN select * GPZH_TEST.T_RAUMEINHEIT b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select * GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select * FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select * from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
names(df)
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
head(df)
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
head(df)
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY a.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
')
dim(df)
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select max(c.JAHR) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select MAX(c.JAHR) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID,MAX(c.JAHR) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, MAX(c.JAHR) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select c.RAUMEINHEIT_ID, MAX(c.JAHR) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID;
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=2018
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
WHERE c.JAHR=MAX(c.JAHR)
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
GROUP BY c.RAUMEINHEIT_ID
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
GROUP BY a.RAUMEINHEIT_ID
) c
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
')
head(df)
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
if(min(df$`MAX(JAHR)`)!=max(df$`MAX(JAHR)`)) stop("Careful, there are different years used. Please check first.")
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHRb. NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHRb. NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR, b.NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, b.NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE,  max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE,  max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select * FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR, b.NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE, NAME, max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR,b.NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
df<-  dbGetQuery(statext,'
select RAUMEINHEIT_ID, VALUE,  max(jahr) FROM
(select a.RAUMEINHEIT_ID, a.VALUE, a.JAHR,b.NAME from GPZH_TEST.T_INDIKATOR_VALUE a
LEFT JOIN (select TYP_ID, RAUMEINHEIT_ID, NAME FROM GPZH_TEST.T_RAUMEINHEIT) b
ON a.RAUMEINHEIT_ID = b.RAUMEINHEIT_ID
WHERE a.INDIKATOR_ID=44 and (b.TYP_ID=3 or b.TYP_ID=4)
) c
GROUP BY c.RAUMEINHEIT_ID, c.VALUE, c.NAME
ORDER BY c.RAUMEINHEIT_ID
')
head(df)
colnames(df)<-c("spatialunit_id","value","time_value")
source("sql/32001_ZH.R")
df<-statbot_sql_32001_ZH()
head(df)
source("sql/32001_ZH.R")
new_df<-statbot_sql_32001_ZH()
new_df$indicator_id<-32001
new_df$timeinfo_id<-1
new_df$dim1_value_id<-NA
new_df$dim2_value_id<-NA
new_df$dim3_value_id<-NA
new_df$dim4_value_id<-NA
new_df<-bring_indicator_values_to_order(new_df,final_length=T)
head(new_df)
write.csv(new_df,"data/values/32001_ZH.csv",row.names = F)
destfile<-"temp/bfs_2300X_1200X_1210X.px"
download.file("https://www.bfs.admin.ch/asset/de/px-x-0602010000_102",destfile=destfile)
download.file("https://www.pxweb.bfs.admin.ch/pxweb/de/px-x-0602010000_102/px-x-0602010000_102/px-x-0602010000_102.px",destfile=destfile)
download.file("https://www.bfs.admin.ch/bfsstatic/dam/assets/13787332/master",destfile=destfile)
install.packages("pxR")
library("pxR")
df<-open.px(destfile)
df<-read.px(destfile)
head(df)
ulimit -s
df<-read.px(destfile)
